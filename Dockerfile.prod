# ビルドステージ
FROM node:18-alpine AS builder

WORKDIR /app

# パッケージ管理ファイルをコピー
COPY package*.json ./

# 依存関係のインストール
RUN npm ci

# ソースコードと設定ファイルをコピー
COPY . .

# 本番用環境変数ファイルをコピー
COPY .env.production .env.production

# アプリケーションのビルドとエクスポート
RUN npm run build
RUN npm run export
